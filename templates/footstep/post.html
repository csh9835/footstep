{% extends 'base/personal_base.html' %}
{% block personal_content %}

<h1 class="p-2">
    {{ post.subject }}
    {% if owner.username == user.username %}
    <span>
        <a class="btn btn-sm btn-primary" href="{% url 'footstep:post_modify' owner.username post.subject %}">수정</a>
    </span>
    <span>
        <a href="javascript:void(0)" class="delete btn btn-sm btn-primary"
           data-uri="{% url 'footstep:post_delete' owner.username post.subject %}">삭제</a>
    </span>
    {% endif %}
</h1>
<hr>
{{ post.content|safe }}
<hr>
<p>작성자: {{ post.author.username }}</p>
<p>작성: {{ post.create_date }}</p>
<p>카테고리: {{ post.category.category_sub }}</p>
{% if post.modify_date %}
<p>수정: {{ post.modify_date }}</p>
{% endif %}
<a href="javascript:void(0)" data-uri="{% url 'footstep:post_recommend' owner.username post.subject %}"
    class="recommend btn btn-sm btn-outline-secondary">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-hand-thumbs-up-fill m-1" viewBox="0 0 16 16">
        <path d="M6.956 1.745C7.021.81 7.908.087 8.864.325l.261.066c.463.116.874.456 1.012.965.22.816.533 2.511.062 4.51a9.84 9.84 0 0 1 .443-.051c.713-.065 1.669-.072 2.516.21.518.173.994.681 1.2 1.273.184.532.16 1.162-.234 1.733.058.119.103.242.138.363.077.27.113.567.113.856 0 .289-.036.586-.113.856-.039.135-.09.273-.16.404.169.387.107.819-.003 1.148a3.163 3.163 0 0 1-.488.901c.054.152.076.312.076.465 0 .305-.089.625-.253.912C13.1 15.522 12.437 16 11.5 16H8c-.605 0-1.07-.081-1.466-.218a4.82 4.82 0 0 1-.97-.484l-.048-.03c-.504-.307-.999-.609-2.068-.722C2.682 14.464 2 13.846 2 13V9c0-.85.685-1.432 1.357-1.615.849-.232 1.574-.787 2.132-1.41.56-.627.914-1.28 1.039-1.639.199-.575.356-1.539.428-2.59z"/>
    </svg>
    <span class="m-1">{{ post.recommend.count }}</span>
</a>
<hr>
{% include 'errors.html' %}
<h4>
    댓글
    <span>
        <a class="btn btn-sm btn-primary" href="{% url 'footstep:comment_create' owner.username post.subject %}">쓰기</a>
    </span>
</h4>
{% block comment_form %}
<!-- 댓글 폼 -->
{% endblock %}
{% if comments %}
    {% for comment in comments %}
    <li>
        {{ comment.content }}
        <a href="javascript:void(0)" data-uri="{% url 'footstep:comment_recommend' owner.username post.subject comment.id %}"
            class="recommend btn btn-sm btn-outline-secondary">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-hand-thumbs-up-fill" viewBox="0 0 16 16">
                <path d="M6.956 1.745C7.021.81 7.908.087 8.864.325l.261.066c.463.116.874.456 1.012.965.22.816.533 2.511.062 4.51a9.84 9.84 0 0 1 .443-.051c.713-.065 1.669-.072 2.516.21.518.173.994.681 1.2 1.273.184.532.16 1.162-.234 1.733.058.119.103.242.138.363.077.27.113.567.113.856 0 .289-.036.586-.113.856-.039.135-.09.273-.16.404.169.387.107.819-.003 1.148a3.163 3.163 0 0 1-.488.901c.054.152.076.312.076.465 0 .305-.089.625-.253.912C13.1 15.522 12.437 16 11.5 16H8c-.605 0-1.07-.081-1.466-.218a4.82 4.82 0 0 1-.97-.484l-.048-.03c-.504-.307-.999-.609-2.068-.722C2.682 14.464 2 13.846 2 13V9c0-.85.685-1.432 1.357-1.615.849-.232 1.574-.787 2.132-1.41.56-.627.914-1.28 1.039-1.639.199-.575.356-1.539.428-2.59z"/>
            </svg>
            <span>{{ comment.recommend.count }}</span>
        </a>
        {% if request.user == comment.author %}
        <span>
            <a class="btn btn-sm btn-outline-secondary" href="{% url 'footstep:comment_modify' owner.username post.subject comment.id %}">수정</a>
        </span>
        <span>
            <a href="javascript:void(0)" class="delete btn btn-sm btn-outline-secondary"
               data-uri="{% url 'footstep:comment_delete' owner.username post.subject comment.id %}">삭제</a>
        </span>
        {% endif %}
    </li>
    {% endfor %}
    {% include 'pagination.html' %} <!-- 페이징 -->
{% else %}
    <span>댓글이 없습니다.</span>
{% endif %}

{% endblock %}


{% block script2 %}
<script>
const recommend_elements = document.getElementsByClassName("recommend");
Array.from(recommend_elements).forEach(function(element) {
    element.addEventListener('click', function() {
        if(confirm("추천하시겠습니까?")) {
            location.href = this.dataset.uri;
        };
    });
});
</script>
{% endblock %}